<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… - Ù…Ø®ØµØµ Ù„Ø·Ù„Ø§Ø¨ Ø¹Ù„ÙˆÙ… Ø§Ù„Ø­Ø§Ø³ÙˆØ¨</title>
    <style>
        /* Same CSS from index.html */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f4f4f4;
            color: #333;
            line-height: 1.6;
            direction: rtl;
        }

        header {
            background-color: #007BFF;
            color: white;
            text-align: center;
            padding: 1rem;
            margin-bottom: 1rem;
        }

        header h1 {
            margin-bottom: 0.5rem;
        }

        main {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
        }

        .section {
            background-color: white;
            border-radius: 5px;
            padding: 1rem;
            margin-bottom: 1rem;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .section h2 {
            margin-bottom: 0.5rem;
        }

        .file-list {
            list-style-type: none;
        }

        .file-item-dashboard {
            padding: 0.5rem;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .file-item-dashboard:last-child {
            border-bottom: none;
        }

        .file-info {
            flex-grow: 1;
        }

        .file-actions button {
            margin-left: 0.5rem;
            padding: 0.25rem 0.5rem;
            border: none;
            border-radius: 3px;
            cursor: pointer;
        }

        .btn-upload {
            background-color: #17a2b8;
            color: white;
        }

        .btn-delete {
            background-color: #dc3545;
            color: white;
        }

        .btn-change-password {
            background-color: #ffc107;
            color: #212529;
            margin-top: 0.5rem;
        }

        input[type="file"] {
            margin-top: 0.5rem;
        }

        #changePasswordForm {
            display: none; /* Initially hidden */
        }

        footer {
            background-color: #333;
            color: white;
            text-align: center;
            padding: 1rem;
            margin-top: 2rem;
        }

        @media (max-width: 768px) {
            main {
                padding: 0 0.5rem;
            }
        }
    </style>
</head>
<body>

    <header>
        <h1>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</h1>
        <p>Ù…Ø±Ø­Ø¨Ù‹Ø§ Ø¨Ø¹ÙˆØ¯ØªÙƒØŒ Abdulhamid</p>
    </header>

    <main>
        <div class="section">
            <h2>ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</h2>
            <form id="changePasswordForm">
                <label for="currentPassword">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø­Ø§Ù„ÙŠØ©:</label><br>
                <input type="password" id="currentPassword" required><br>
                <label for="newPassword">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©:</label><br>
                <input type="password" id="newPassword" required><br>
                <button type="submit" class="btn-change-password">ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</button>
            </form>
            <button id="showChangePasswordBtn" class="btn-change-password">ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</button>
        </div>

        <div class="section">
            <h2>Ø±ÙØ¹ Ù…Ù„Ù</h2>
            <input type="file" id="fileInput" multiple>
            <button id="uploadButton" class="btn-upload">Ø±ÙØ¹ Ø§Ù„Ù…Ù„ÙØ§Øª</button>
            <p id="uploadStatus"></p>
        </div>

        <div class="section">
            <h2>Ù…Ù„ÙØ§ØªÙƒ</h2>
            <ul id="fileList" class="file-list">
                <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¡ Ù‡Ø°Ù‡ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ù…Ù† Ø®Ù„Ø§Ù„ JavaScript -->
            </ul>
        </div>

        <div class="section">
            <button id="logoutButton">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>
        </div>
    </main>

    <footer>
        <p>Ù…Ù† Ø¥Ø¹Ø¯Ø§Ø¯ Abdulhamid â€“ Ù…Ø®ØµØµ Ù„Ø·Ù„Ø§Ø¨ Ø¹Ù„ÙˆÙ… Ø§Ù„Ø­Ø§Ø³ÙˆØ¨</p>
    </footer>

    <script>
        // --- Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ---
        let storedPassword = localStorage.getItem('masterPassword');
        if (!storedPassword) {
             storedPassword = "defaultPassword123";
             localStorage.setItem('masterPassword', storedPassword);
        }

        let files = JSON.parse(localStorage.getItem('sharedFiles')) || [];

        // --- Ø¹Ù†Ø§ØµØ± DOM ---
        const fileInput = document.getElementById('fileInput');
        const uploadButton = document.getElementById('uploadButton');
        const fileList = document.getElementById('fileList');
        const changePasswordForm = document.getElementById('changePasswordForm');
        const showChangePasswordBtn = document.getElementById('showChangePasswordBtn');
        const changePasswordFormElement = document.getElementById('changePasswordForm');
        const currentPasswordInput = document.getElementById('currentPassword');
        const newPasswordInput = document.getElementById('newPassword');
        const logoutButton = document.getElementById('logoutButton');
        const uploadStatus = document.getElementById('uploadStatus');

        // --- Ø¹Ø±Ø¶ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù„ÙØ§Øª ---
        function renderFileList() {
            fileList.innerHTML = ''; // Ù…Ø³Ø­ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
            if (files.length === 0) {
                const emptyItem = document.createElement('li');
                emptyItem.textContent = 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù„ÙØ§Øª.';
                fileList.appendChild(emptyItem);
                return;
            }

            files.forEach((file, index) => {
                const listItem = document.createElement('li');
                listItem.className = 'file-item-dashboard';

                const icon = file.type === 'pdf' ? 'ğŸ“„' : file.type === 'video' ? 'ğŸ¥' : file.type === 'zip' ? 'ğŸ“¦' : 'ğŸ–¼ï¸';
                listItem.innerHTML = `
                    <div class="file-info">
                        ${icon} ${file.name}
                    </div>
                    <div class="file-actions">
                        <a href="#" onclick="downloadFile(${index})"><button>ØªÙ†Ø²ÙŠÙ„</button></a>
                        <button onclick="deleteFile(${index})">Ø­Ø°Ù</button>
                    </div>
                `;
                fileList.appendChild(listItem);
            });
        }

        // --- Ø±ÙØ¹ Ø§Ù„Ù…Ù„ÙØ§Øª ---
        uploadButton.addEventListener('click', () => {
            const filesToUpload = Array.from(fileInput.files);
            if (filesToUpload.length === 0) {
                uploadStatus.textContent = 'ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„ÙØ§Øª Ø£ÙˆÙ„Ø§Ù‹.';
                return;
            }

            // Ù†Ù‚ÙˆÙ… Ø¨Ø¨Ø³Ø§Ø·Ø© Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù„ÙØ§Øª Ø¥Ù„Ù‰ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© (ÙÙŠ ØªØ·Ø¨ÙŠÙ‚ Ø­Ù‚ÙŠÙ‚ÙŠØŒ ÙŠØ¬Ø¨ Ø±ÙØ¹Ù‡Ø§ Ø¥Ù„Ù‰ Ø®Ø§Ø¯Ù…)
            filesToUpload.forEach(file => {
                // Ù‡Ù†Ø§ Ù†Ù‚ÙˆÙ… Ø¨Ø¥Ù†Ø´Ø§Ø¡ ÙƒØ§Ø¦Ù† Ù…Ù„Ù Ø¨Ø³ÙŠØ·
                // ÙÙŠ ØªØ·Ø¨ÙŠÙ‚ Ø­Ù‚ÙŠÙ‚ÙŠØŒ ÙŠØ¬Ø¨ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù Ø¥Ù„Ù‰ Ø®Ø§Ø¯Ù… ÙˆØ­ÙØ¸ Ù…Ø³Ø§Ø±Ù‡
                const newFile = {
                    name: file.name,
                    type: file.type.split('/')[1] || 'unknown', // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù†ÙˆØ¹ Ø§Ù„Ù…Ù„Ù (pdf, mp4, ...)
                    size: file.size,
                    // ÙÙŠ ØªØ·Ø¨ÙŠÙ‚ Ø­Ù‚ÙŠÙ‚ÙŠØŒ Ø³ÙŠÙƒÙˆÙ† Ù‡Ù†Ø§Ùƒ Ù…Ø³Ø§Ø± Ø£Ùˆ Ø±Ø§Ø¨Ø· Ù„Ù„Ù…Ù„Ù
                    url: URL.createObjectURL(file) // Ù‡Ø°Ø§ ÙÙ‚Ø· Ù„Ø¹Ø±Ø¶Ù‡ ÙÙŠ Ø§Ù„Ù…ØªØµÙØ­ (ØºÙŠØ± Ù…Ù†Ø§Ø³Ø¨ Ù„Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„ÙØ¹Ù„ÙŠ)
                };
                files.push(newFile);
            });

            localStorage.setItem('sharedFiles', JSON.stringify(files)); // Ø­ÙØ¸ ÙÙŠ localStorage
            renderFileList(); // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
            fileInput.value = ''; // Ù…Ø³Ø­ Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©
            uploadStatus.textContent = `ØªÙ… Ø±ÙØ¹ ${filesToUpload.length} Ù…Ù„Ù(Ø§Øª).`;
        });

        // --- Ø­Ø°Ù Ù…Ù„Ù ---
        function deleteFile(index) {
            if (confirm(`Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù "${files[index].name}"ØŸ`)) {
                files.splice(index, 1); // Ø­Ø°Ù Ø§Ù„Ù…Ù„Ù Ù…Ù† Ø§Ù„Ù…ØµÙÙˆÙØ©
                localStorage.setItem('sharedFiles', JSON.stringify(files)); // Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª
                renderFileList(); // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
            }
        }

        // --- ØªÙ†Ø²ÙŠÙ„ Ù…Ù„Ù ---
        function downloadFile(index) {
            // ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù…Ø«Ø§Ù„ØŒ Ù†Ø³ØªØ®Ø¯Ù… URL.createObjectURL Ø§Ù„Ø°ÙŠ ØªÙ… Ø¥Ù†Ø´Ø§Ø¤Ù‡ Ø¹Ù†Ø¯ Ø§Ù„Ø±ÙØ¹
            // Ù„ÙƒÙ† ÙÙŠ ØªØ·Ø¨ÙŠÙ‚ Ø­Ù‚ÙŠÙ‚ÙŠØŒ ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ù‡Ù†Ø§Ùƒ Ø±Ø§Ø¨Ø· Ù…Ø¨Ø§Ø´Ø± Ù„Ù„Ù…Ù„Ù
            const fileUrl = files[index].url;
            if (fileUrl) {
                const link = document.createElement('a');
                link.href = fileUrl;
                link.download = files[index].name;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            } else {
                alert("Ù„Ø§ ÙŠÙ…ÙƒÙ† ØªÙ†Ø²ÙŠÙ„ Ù‡Ø°Ø§ Ø§Ù„Ù…Ù„Ù ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„ÙˆÙ‚Øª.");
            }
        }

        // --- ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ---
        showChangePasswordBtn.addEventListener('click', () => {
            changePasswordForm.style.display = 'block';
            showChangePasswordBtn.style.display = 'none';
        });

        changePasswordFormElement.addEventListener('submit', (e) => {
            e.preventDefault();
            const currentPassword = currentPasswordInput.value;
            const newPassword = newPasswordInput.value;

            if (currentPassword !== storedPassword) {
                alert("ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø­Ø§Ù„ÙŠØ© ØºÙŠØ± ØµØ­ÙŠØ­Ø©.");
                return;
            }

            if (newPassword.length < 6) {
                alert("ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„ 6 Ø£Ø­Ø±Ù.");
                return;
            }

            storedPassword = newPassword;
            localStorage.setItem('masterPassword', storedPassword);
            alert("ØªÙ… ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø¨Ù†Ø¬Ø§Ø­!");
            changePasswordForm.style.display = 'none';
            showChangePasswordBtn.style.display = 'inline-block';
            currentPasswordInput.value = '';
            newPasswordInput.value = '';
        });

        // --- ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ ---
        logoutButton.addEventListener('click', () => {
            alert("ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬.");
            window.location.href = 'index.html'; // Ø¥Ø¹Ø§Ø¯Ø© ØªÙˆØ¬ÙŠÙ‡ Ø¥Ù„Ù‰ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
        });

        // --- ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø© ---
        document.addEventListener('DOMContentLoaded', () => {
            renderFileList();
        });
    </script>
</body>
</html>